<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jupiter Jayna's Plotter Art Control Centre</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="layout">
        <button id="toggleDebug" title="Show/hide control panel">Hide</button>
        <div class="canvas-area">
            <div id="svgContainer"></div>
            <div id="previewOverlay" aria-live="polite" hidden>
                <div class="spinner"></div>
                <span>Generating preview‚Ä¶</span>
            </div>
            <div class="zoom-control" aria-label="Preview zoom control">
                <label for="previewZoomSlider">Zoom</label>
                <input type="range" id="previewZoomSlider" min="10" max="1000" step="10" value="100">
                <span id="previewZoomValue">100%</span>
                <button id="previewCenter" type="button" aria-label="Center preview">Center</button>
                <button id="previewReset" type="button" aria-label="Reset zoom and center">Reset</button>
                <button id="previewFit" type="button" aria-label="Fit to view">Fit</button>
            </div>
        </div>
        <div class="debug-panel">
            <div class="panel-title">
                <h2>Jupiter Jayna's Plotter Art Control Centre</h2>
            </div>
            <div class="control-tabs">
                <button class="control-tab active" data-target="drawingPanel">Drawing Control</button>
                <button class="control-tab" data-target="plotterPanel">Plotter Control</button>
            </div>
            <div id="drawingPanel" class="preview-section control-panel active">
                <div class="preview-controls">
                    <div class="control-row">
                        <div class="control-section half-width">
                            <h4>Drawing</h4>
                            <div class="control-section-content">
                                <select id="drawingSelect"></select>
                            </div>
                        </div>
                        <div class="control-section half-width">
                            <h4>SVG</h4>
                            <div class="control-section-content">
                                <button id="exportSvg" title="Save current drawing as SVG file">Export SVG</button>
                            </div>
                        </div>
                    </div>
                    <div class="control-section collapsible" data-role="drawing-settings-section">
                        <button id="drawingSettingsToggle" class="collapsible-toggle" type="button"
                            aria-expanded="true" aria-controls="drawingSettingsContent">
                            <span class="collapsible-title">Drawing Settings</span>
                            <span class="collapsible-icon" aria-hidden="true"></span>
                        </button>
                        <div id="drawingSettingsContent" class="control-section-content drawing-settings">
                            <div id="drawingControlsContainer" class="drawing-controls-container">
                                <p class="drawing-controls-empty">No adjustable settings for this drawing.</p>
                            </div>
                        </div>
                    </div>
                    <div class="control-section collapsible" data-role="hatch-settings-section">
                        <button id="hatchSettingsToggle" class="collapsible-toggle" type="button"
                            aria-expanded="true" aria-controls="hatchSettingsContent">
                            <span class="collapsible-title">Hatching</span>
                            <span class="collapsible-icon" aria-hidden="true"></span>
                        </button>
                        <div id="hatchSettingsContent" class="control-section-content hatch-controls">
                            <label for="hatchStyleControl">Hatch Style</label>
                            <select id="hatchStyleControl" class="plotter-button">
                                <option value="serpentine">Serpentine</option>
                                <option value="scanline">Scanline</option>
                                <option value="contour">Contour</option>
                                <option value="skeleton">Skeleton</option>
                                <option value="none">None</option>
                            </select>
                            <label class="hatch-slider-label" for="hatchSpacingControl">
                                <span>Hatch Spacing</span>
                                <span id="hatchSpacingValue" class="drawing-control-value">2.0 mm</span>
                            </label>
                            <input type="range" id="hatchSpacingControl" min="0.1" max="10" step="0.05">
                            <label class="hatch-slider-label" for="hatchInsetControl">
                                <span>Hatch Offset</span>
                                <span id="hatchInsetValue" class="drawing-control-value">1.0 mm</span>
                            </label>
                            <input type="range" id="hatchInsetControl" min="0" max="5" step="0.05">
                            <label class="hatch-boundary-toggle">
                                <input type="checkbox" id="hatchLinkControl" checked>
                                <span>Link spacing &amp; offset</span>
                            </label>
                            <label class="hatch-boundary-toggle">
                                <input type="checkbox" id="hatchBoundaryControl">
                                <span>Draw boundary outline</span>
                            </label>
                        </div>
                    </div>
                    <div class="control-section collapsible" data-role="paper-settings-section">
                        <button id="paperSettingsToggle" class="collapsible-toggle" type="button"
                            aria-expanded="true" aria-controls="paperSettingsContent">
                            <span class="collapsible-title">Paper &amp; Margin</span>
                            <span class="collapsible-icon" aria-hidden="true"></span>
                        </button>
                        <div id="paperSettingsContent" class="control-section-content paper-controls">
                            <select id="paperSelect" class="plotter-button">
                                <!-- Populated dynamically from paper config -->
                            </select>
                            <div id="paperDescription" class="paper-description"></div>
                            <div class="margin-controls merged-margin-controls">
                                <label class="margin-label" for="marginSlider">
                                    <span>Margin</span>
                                    <span class="drawing-control-value" id="marginValueLabel">20 mm</span>
                                </label>
                                <input type="range" id="marginSlider" min="0" max="100" step="1">
                            </div>
                        </div>
                    </div>
                    <div class="control-section collapsible" data-role="medium-settings-section">
                        <button id="mediumSettingsToggle" class="collapsible-toggle" type="button"
                            aria-expanded="true" aria-controls="mediumSettingsContent">
                            <span class="collapsible-title">Medium</span>
                            <span class="collapsible-icon" aria-hidden="true"></span>
                        </button>
                        <div id="mediumSettingsContent" class="control-section-content medium-controls">
                            <select id="mediumSelect" class="plotter-button">
                                <!-- Populated dynamically from medium config -->
                            </select>
                            <label for="mediumColorList" class="medium-colors-label">Disabled Colors</label>
                            <div id="mediumColorList" class="medium-color-list" aria-describedby="mediumColorHelp" data-disabled="true">
                                <p class="medium-color-empty">Select a medium to manage pens.</p>
                            </div>
                            <p id="mediumColorHelp" class="medium-color-help">Check colors to disable pens; entries highlighted in blue are currently used in the drawing.</p>
                        </div>
                    </div>


                    <div class="control-section">
                        <h4>Preview</h4>
                        <div class="control-section-content">
                            <button id="toggleOrientation" title="Switch between portrait and landscape orientation">Portrait</button>
                            <button id="toggleRulers" title="Show/hide ruler and margin guides">Show Ruler</button>
                            <button id="updateSvg" title="Manually update the preview">Update Preview</button>
                            <button id="toggleRefresh" class="paused" title="Toggle automatic preview refresh">Resume Refresh</button>
                        </div>
                    </div>
                    
                </div>
            </div>
            <div id="plotterPanel" class="plotter-section control-panel">
                <div class="plotter-controls">
                    <div class="control-section">
                        <h4>Plot</h4>
                        <div class="control-section-content">
                            <select id="layerSelect">
                                <option value="all">Show All Layers</option>
                            </select>
                            <button id="plotterPlotLayer" class="plotter-button" disabled title="Plot the currently selected layer">Plot Layer</button>
                            <button id="plotterResumePlot" class="plotter-button" disabled title="Resume last interrupted plot">Resume Plot</button>
                            <button id="plotterStopPlot" class="plotter-button danger" title="Stop the current plotting operation">Stop Plot</button>
                        </div>
                    </div>
                    <div class="control-section">
                        <h4>Setup</h4>
                        <div class="control-section-content">
                            <button id="plotterHome" class="plotter-button" title="Return plotter to home position"><span class="setup-icon">üè†</span></button>
                            <button id="plotterCycle" class="plotter-button" title="Cycle pen up and down"><span class="setup-icon">‚àû</span></button>
                            <button id="plotterAlign" class="plotter-button" title="Align pen with paper"><span class="setup-icon">‚öè</span></button>
                            <button id="plotterToggle" class="plotter-button" title="Toggle pen position"><span class="setup-icon">‚áÖ</span></button>
                            <button id="plotterDisableMotors" class="plotter-button" title="Turn off plotter motors">
                                <span class="power-icon" style="color: #d32f2f;">‚èª</span>
                            </button>
                            <button id="toggleMute" class="plotter-button" title="Toggle completion sound">
                                <span class="speaker-icon">üîä</span>
                            </button>
                        </div>
                        <div class="pen-controls">
                            <div class="slider-group">
                                <label for="penPosDown">Pen Down: <span id="penPosDownValue">50</span></label>
                                <input type="range" id="penPosDown" min="0" max="100" value="50">
                            </div>
                            <div class="slider-group">
                                <label for="penPosUp">Pen Up: <span id="penPosUpValue">95</span></label>
                                <input type="range" id="penPosUp" min="0" max="100" value="95">
                            </div>
                            <div class="slider-group">
                                <label for="penRateLower">Pen Rate Lower: <span id="penRateLowerValue">10</span></label>
                                <input type="range" id="penRateLower" min="1" max="100" value="10">
                            </div>
                        </div>
                    </div>
                    <div class="control-section">
                        <h4>Medium</h4>
                        <div class="control-section-content">
                            <div class="slider-group">
                                <label for="maxTravelPerLayer">Max Travel Per Layer: <span id="maxTravelPerLayerValue">5 m</span></label>
                                <input type="range" id="maxTravelPerLayer" min="1" max="101" step="1" value="5">
                                <p class="control-help">Cap pen travel per layer.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="debug-section">
                <h3>Messages</h3>
                <div class="debug-tabs">
                    <button class="tab-button active" data-tab="all">All</button>
                    <button class="tab-button" data-tab="plots">Just Plots</button>
                </div>
                <div id="debugLog"></div>
            </div>
        </div>
    </div>

    
    <script type="module" src="/js/main.js"></script>


</body>
</html>
